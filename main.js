(()=>{var t={669:()=>{!function(t){var e=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):(e="on"+e,t.attachEvent?t.attachEvent(e,i):t[e]=i)},i=function(i,s,o){this.decaf=i,this.ui=s,this._display=o,this.display=document.createElement("div"),this.display.className="decafmud display "+this.decaf.options.set_display.fgclass+"7",this._display.appendChild(this.display);var n=this;e(this._display,"scroll",(function(t){n.onScroll()})),e(this._display,"mousedown",(function(t){2===t.which&&n.decaf.store.get("ui/middle-click-scroll",!1)&&(n.scroll(),t.cancelBubble&&(t.cancelBubble=!0),t.preventDefault())})),this.decaf.loaded_plugs.display=this,this.splash=this.display.innerHTML,this.orig_title=null,this.clear(),this.message('<br><a href="http://decafmud.stendec.me">DecafMUD</a> v'+t.version+' by Stendec &lt;<a href="mailto:stendec365@gmail.com">stendec365@gmail.com</a>&gt;<br>'),this.splash.length>0&&this.message(this.splash+"<br>")},s=parseInt("00000001",2),o=parseInt("00000010",2),n=parseInt("00000100",2),r=parseInt("00001000",2),a=parseInt("00010000",2),l=parseInt("00100000",2),h=parseInt("01000000",2),c=parseInt("10000000",2);i.prototype.state=0,i.prototype.c_fg=7,i.prototype.c_bg=0,i.prototype.c_fnt=0,i.prototype.readyClear=!1,i.prototype.endSpace=!1,i.prototype.scrollTime=null,i.prototype.willScroll=!1,i.prototype.vt100Warning=!1,i.prototype.mxp=!1,i.prototype.clear=function(){clearTimeout(this.scrollTime),this.display.innerHTML="",this.reset(),this.inbuf=[],this.outbuf=[]},i.prototype.reset=function(){this.state=0,this.c_fg=7,this.c_bg=0,this.c_fnt=0,this.readyClear=!1,this.endSpace=!1},i.prototype.sbw=void 0,i.prototype.scrollbarWidth=function(){if(this.sbw)return this.sbw;var t=this._display.style.overflowY;return this._display.style.overflowY="scroll",this._display.offsetWidth>this._display.clientWidth?(this.sbw=this._display.offsetWidth-this._display.clientWidth,this.sbw):(this._display.style.overflowY=t,15)},i.prototype.cz=void 0,i.prototype.charSize=function(){if(this.cz)return this.cz;var t=document.createElement("span");t.innerHTML="W",this.display.appendChild(t);var e=t.offsetWidth,i=t.offsetHeight;return this.display.removeChild(t),this.cz=[e,i],this.cz},i.prototype.getSize=function(){var t;t=this.decaf.options.set_display.scrollbarwidth?this.decaf.options.set_display.scrollbarwidth:this.scrollbarWidth();var e=this._display.clientWidth-t,i=this._display.clientHeight,s=this.charSize(),o=s[0],n=s[1];return[Math.floor(e/o)+1,Math.floor(i/n)]},i.prototype.handleData=function(t){this.inbuf.push(t),this.processData()},i.prototype.processData=function(){if(!(this.inbuf.length<1)){var e=this.inbuf.join("");this.inbuf=[];for(var i=t.ESC;e.length>0;){var s=e.indexOf(i);if(-1===s){this.outbuf.push(e.replace(/</g,"&lt;"));break}s>0&&(this.readyClear=!1,this.outbuf.push(e.substr(0,s).replace(/</g,"&lt;")),e=e.substr(s));var o=this.readANSI(e);if(!1===o){this.inbuf.push(e);break}e=o}e=this.outbuf.join(""),this.outbuf=[],this.outColor(!1),this.needline=!e.endsWith("\n"),this._display.setAttribute("aria-busy",!0);var n=document.createElement("span");n.innerHTML=e.replace(/\n\r?/g,"<br>").replace(/> /g,">&nbsp;").replace(/ ( +)/g,(function(t){return 2===t.length?" &nbsp;":" "+new Array(t.length-1).join("&nbsp;")+" "})),this.shouldScroll(),this.display.appendChild(n),this.doScroll()}},i.prototype.readANSI=function(e){if(e.length<2)return!1;if("["==e.charAt(1))return-1!==(i=e.substr(2).search(/[\x40-\x7E]/))&&(i+=2,this.handleAnsiCSI(e.substr(2,i-1)),e.substr(i+1));if("]"==e.charAt(1)){var i=e.substr(2).indexOf(t.BEL),s=e.substr(2).indexOf(t.ESC+"\\");return(s<i||-1===i)&&(i=s),-1!==i&&(i+=2,e.substr(i))}return e.substr(1)},i.prototype.handleAnsiCSI=function(t){switch(t.charAt(t.length-1)){case"m":var e=this.state,i=this.c_fg,d=this.c_bg,p=this.c_fnt;1===t.length&&(t="0m");for(var u=t.substr(0,t.length-1).split(";"),f=u.length,g=0;g<f;g++){var y=parseInt(u[g]);if(38===y){if(g++,++g>=f)break;this.c_fg=parseInt(u[g])}else if(39===y)this.c_fg=7;else if(48===y){if(g++,++g>=f)break;this.c_bg=parseInt(u[g])}else{if(29<y&&y<38){this.c_fg=y-30;continue}if(39<y&&y<48){this.c_bg=y-40;continue}if(0===y){this.state=0,this.c_fg=7,this.c_bg=0,this.c_fnt=0;continue}if(1===y){this.state|=s,this.state&=~l;continue}if(2===y)this.state&=~s,this.state|=l;else if(3===y)this.state|=n;else if(4===y)this.state|=a,this.state&=~c;else if(y<7)this.state|=r;else if(7===y)this.state|=o;else{if(8===y)continue;9===y?this.state|=h:y<20?this.c_fnt=y-10:21===y?(this.state|=c,this.state&=~a):22===y?this.state&=~(s|l):23===y?this.state&=~n:24===y?this.state&=~(a|c):25===y?this.state&=~r:27===y?this.state&=~o:29===y?this.state&=~h:49===y?this.c_bg=0:89<y&&y<98?(this.state|=s,this.state&=~l,this.c_fg=y-90):99<y&&y<108&&(this.c_bg=y-92)}}}return this.state===e&&i===this.c_fg&&d===this.c_bg&&p===this.c_fnt||this.outColor(),void(this.readyClear=!1);case"@":case"C":var b=1;return t.length>1&&(b=parseInt(t.substr(0,t.length-1))),this.outbuf.push(new Array(b+1).join(" ")),void(this.readyClear=!1);case"E":return b=1,t.length>1&&(b=parseInt(t.substr(0,t.length-1))),this.outbuf.push(new Array(b+1).join("\n")),void(this.readyClear=!1);case"H":return void(1===t.length&&(this.readyClear=!0));case"J":var v=0;return t.length>1&&(v=parseInt(t.substr(0,t.length-1))),(0===v&&this.readyClear||2===v)&&this.clear(),void(this.readyClear=!1);case"K":if(v=0,t.length>1&&(v=parseInt(t.substr(0,t.length-1))),2===v){var m=!1;if(this.outbuf.length>0)for(;this.outbuf.length>0;){var _=this.outbuf[this.outbuf.length-1];if(-1!==_.lastIndexOf("\n")){m=!0,this.outbuf[this.outbuf.length-1]=_.substr(0,_.lastIndexOf("\n")+1);break}this.outbuf.pop()}if(!m)for(;this.display.childElementCount>0;){var S=this.display.children[this.display.childElementCount-1],C=S.innerHTML;if(-1!==C.lastIndexOf("<br>")){m=!0,S.innerHTML=C.substr(0,C.lastIndexOf("<br>")+4);break}this.display.removeChild(S)}}else 1===v&&this.decaf.debugString("ANSI Sequence ESC ["+t+" -- TODO: Mode 1");return}-1!=="ABCDEFGHJKSTfnsulh".indexOf(t.charAt(t.length-1))?this.vt100Warning||(this.decaf.debugString("Notice: This display handler only provides a subset of VT100, and doesn't handle cursor movement commands."),this.vt100Warning=!0):this.decaf.debugString("Unhandled ANSI Sequence: ESC ["+t)},i.prototype.outColor=function(t,e){var i,d=this.c_fg,p=this.c_bg,u=this.state,f=this.decaf.options.set_display;if(u&s&&d<8&&(d+=8),i=(!1!==t?"</span>":"")+'<span class="',u&n&&(i+="italic "),u&r&&(i+="blink "),u&a&&(i+="underline "),u&c&&(i+="doubleunderline "),u&l&&(i+="faint "),u&h&&(i+="strike "),u&o&&(p=d,d=this.c_bg),0!==this.c_fnt&&(i+=f.fntclass+this.c_fnt+" "),7!==d&&(i+=f.fgclass+d+" "),0!==p&&(i+=f.bgclass+p),i+='">',!0===e)return i;this.outbuf.push(i)},i.prototype.message=function(t,e,i){void 0===e&&(e="message");var s=document.createElement("span");this.needline&&!1!==i&&(s.innerHTML="<br>"),this.needline=!1,s.innerHTML+=t.replace(/ ( +)/g,(function(t){return 2===t.length?" &nbsp;":" "+new Array(t.length-1).join("&nbsp;")+" "}))+"<br>",this.shouldScroll(),this.display.appendChild(s),this.doScroll()},i.prototype.shouldScroll=function(t){if(void 0===this.willScroll&&"hidden"!==this._display.style.overflowY&&(this.willScroll=this._display.scrollTop>=this._display.scrollHeight-this._display.offsetHeight,!1!==t&&!1===this.willScroll&&!this.scrollTarget)){var e=document.createElement("hr");e.className="scroll-point",this.scrollTarget=e,this.display.appendChild(e),this.ui&&this.ui.showScrollButton&&this.ui.showScrollButton()}},i.prototype.doScroll=function(){var t=this;clearTimeout(this.scrollTime),this.willScroll?this.scrollTime=setTimeout((function(){t.scrollTarget&&(t.scrollTarget.parentNode.removeChild(t.scrollTarget),t.scrollTarget=void 0),t._display.setAttribute("aria-busy",!1),t.scroll(),t.willScroll=void 0}),5):this.scrollTime=setTimeout((function(){t._display.setAttribute("aria-busy",!1),t.willScroll=void 0}),5)},i.prototype.scrollNew=function(){if(this.scrollTarget){var t=this.scrollTarget.offsetTop;t>this._display.scrollTop?this._display.scrollTop=t:this.scroll()}},i.prototype.scroll=function(){"hidden"!==this._display.style.overflowY&&(this._display.scrollTop=this._display.scrollHeight)},i.prototype.onScroll=function(){void 0!==this.scrollTarget&&this._display.scrollTop>=this._display.scrollHeight-this._display.offsetHeight&&(this.scrollTarget&&(this.scrollTarget.parentNode.removeChild(this.scrollTarget),this.scrollTarget=void 0),this.ui&&this.ui.hideScrollButton&&this.ui.hideScrollButton())},i.prototype.scrollUp=function(){var t=this._display.scrollTop-this._display.clientHeight;t<0&&(t=0),this._display.scrollTop=t},i.prototype.scrollDown=function(){var t=this._display.scrollTop+this._display.clientHeight;this._display.scrollTop=t},i.prototype.tags={VAR:{default:!0,secure:!0,want:!0,open_tag:"",close_tag:"",arg_order:["name","desc","private","publish","delete","add","remove"],arguments:{name:"",desc:"",private:!1,publish:!0,delete:!1,add:!0,remove:!1},handler:function(){}},B:{default:!0,secure:!1,want:!1,open_tag:'<b class="mxp">',close_tag:"</b>"},BOLD:"B",STRONG:"B",I:{default:!0,secure:!1,want:!1,open_tag:'<i class="mxp">',close_tag:"</i>"},ITALIC:"I",EM:"I",U:{default:!0,secure:!1,want:!1,open_tag:'<u class="mxp">',close_tag:"</u>"},UNDERLINE:"U",S:{default:!0,secure:!1,want:!1,open_tag:'<s class="mxp">',close_tag:"</s>"},STRIKEOUT:"S",COLOR:{default:!0,secure:!1,want:!1,open_tag:'<span class="mxp mxp-color" style="color:&fore;;background-color:&back;">',close_tag:"</span>",arg_order:["fore","back"],arguments:{fore:"inherit",back:"inherit"}},C:"COLOR",HIGH:{default:!0,secure:!1,want:!0}},t.plugins.Display.standard=i}(DecafMUD)},129:()=>{!function(t){var e={"Â¤":"â‚¬","Â¦":"Å ","Â¨":"Å¡","Â´":"Å½","Â¸":"Å¾","Â¼":"Å’","Â½":"Å“","Â¾":"Å¸"},i="[",s="[",o={};for(var n in e)i+=n,s+=e[n],o[e[n]]=n;i=new RegExp(i+"]","g"),s=new RegExp(s+"]","g"),t.plugins.Encoding.iso885915={proper:"ISO-8859-15",decode:function(t){return[t.replace(i,(function(t){return e[t]})),""]},encode:function(t){return t.replace(s,(function(t){return o[t]}))}}}(DecafMUD)},535:()=>{!function(t){var e=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):(e="on"+e,t.attachEvent?t.attachEvent(e,i):t[e]=i)},s=/Firefox\//.test(navigator.userAgent),o=function(t){var i=this;if(this.decaf=t,this.container=t.options.set_interface.container,"string"==typeof this.container&&(this.container=document.querySelector(this.container)),!("nodeType"in this.container))throw"The container must be a node in the DOM!";this.container.setAttribute("role","application"),this.container.className+=" decafmud mud interface",this.el_display=document.createElement("div"),this.el_display.className="decafmud mud-pane primary-pane",this.el_display.setAttribute("role","log"),this.el_display.setAttribute("aria-live","assertive"),this.el_display.setAttribute("tabIndex","0"),this.container.appendChild(this.el_display),e(this.el_display,"keydown",(function(t){i.displayKey(t)})),this._input=document.createElement("div"),this._input.className="decafmud input-cont",this.tray=document.createElement("div"),this.tray.className="decafmud icon-tray",this._input.appendChild(this.tray),this.toolbuttons={},this.infobars=[],this.icons=[],this.toolbar=document.createElement("div"),this.toolbar.className="decafmud toolbar",this.toolbar.setAttribute("role","toolbar");var s=function(){this.className&&(this.className=this.className.replace(" visible",""))};e(this.toolbar,"mousemove",s),e(this.toolbar,"blur",s),this.input=document.createElement("input"),this.input.id="inputelement",this.input.title="MUD Input".tr(this.decaf),this.input.setAttribute("role","textbox"),this.input.setAttribute("aria-label",this.input.title),this.input.type="text",this.input.className="decafmud input",this._input.insertBefore(this.input,this._input.firstChild),this.container.appendChild(this._input),e(this.input,"keydown",(function(t){i.handleInput(t)}));var o=function(t){i.handleBlur(t)};e(this.input,"blur",o),e(this.input,"focus",o),this.history=[],this.historyPosition=-1;for(var n=0;n<100;n++)this.history[n]="";return this.reset(),e(window,"resize",this.resizeScreenFromEvent.bind(this,"window resize")),"onhelp"in window&&(window.onhelp=function(){return!1}),window.onbeforeunload=this.unloadPageFromEvent.bind(this),this.input.focus(),this};o.prototype.toString=function(){return"<DecafMUD Interface: Simple"+(this.container.id?" (#"+this.container.id+")":"")+">"},o.prototype.toolbutton_id=-1,o.prototype.echo=!0,o.prototype.inpFocus=!1,o.prototype.old_parent=void 0,o.prototype.next_sib=void 0,o.prototype.input=void 0,o.prototype.display=void 0,o.prototype.splash=null,o.prototype.splash_st=null,o.prototype.splash_pgi=null,o.prototype.splash_pgt=null,o.prototype.splash_old=null,o.prototype.scrollButton=void 0,o.supports={tabComplete:!0,multipleOut:!1,fullscreen:!0,editor:!1,splash:!0},o.prototype.initSplash=function(e,i){void 0===e&&(e=0),void 0===i&&(i="Discombobulating interface recipient...".tr(this.decaf)),this.old_y=this.el_display.style.overflowY,this.el_display.style.overflowY="hidden",this.splash=document.createElement("div"),this.splash.className="decafmud splash",this.splash.innerHTML='<h2 class="decafmud heading"><a href="http://decafmud.stendec.me/">DecafMUD</a> <span class="version">v'+t.version+"</span></h2>",this.splash_pg=document.createElement("div"),this.splash_pg.className="decafmud progress",this.splash_pg.setAttribute("role","progressbar"),this.splash_pg.setAttribute("aria-valuemax",100),this.splash_pg.setAttribute("aria-valuemin",0),this.splash_pg.setAttribute("aria-valuenow",e),this.splash_pg.setAttribute("aria-valuetext","{0}%".tr(this.decaf,e)),this.splash_pgi=document.createElement("div"),this.splash_pgi.className="decafmud inner-progress",this.splash_pgi.style.cssText="width:"+e+"%;",this.splash_pg.appendChild(this.splash_pgi),this.splash_pgt=document.createElement("div"),this.splash_pgt.className="decafmud progress-text",this.splash_pgt.innerHTML="{0}%".tr(this.decaf,e),this.splash_pg.appendChild(this.splash_pgt),this.splash.appendChild(this.splash_pg),this.splash_st=document.createElement("div"),this.splash_st.className="decafmud status",this.splash_st.innerHTML=i,this.splash.appendChild(this.splash_st),this.splash_old=document.createElement("div"),this.splash_old.className="decafmud old",this.splash_old.innerHTML="",this.splash.appendChild(this.splash_old),this.container.appendChild(this.splash)},o.prototype.endSplash=function(){this.container.removeChild(this.splash),this.el_display.style.overflowY=this.old_y,this.splash_err=!1,this.splash=this.splash_pg=this.splash_pgi=this.splash_pgt=this.splash_st=null},o.prototype.updateSplash=function(t,e){if(null!==this.splash&&!this.splash_err){if(void 0!==t){var i="{0}%".tr(this.decaf,t);this.splash_pg.setAttribute("aria-valuenow",t),this.splash_pg.setAttribute("aria-valuetext",i),this.splash_pgt.innerHTML=i,this.splash_pgi.style.cssText="width:"+t+"%;"}if(e){var s=document.createElement("div");(i=this.splash_st.innerHTML).endsWith("...")&&(i+="done."),s.innerHTML=i,this.splash_old.insertBefore(s,this.splash_old.firstChild),this.splash_st.innerHTML=e}}},o.prototype.splashError=function(t){return null!==this.splash&&(this.splash_pgt.innerHTML="<b>Error</b>",this.splash_pgi.className+=" error",this.splash_st.innerHTML=t,this.splash_err=!0,!0)},o.prototype.sizeel=void 0,o.prototype.sizetm=void 0,o.prototype.showSize=function(){if(clearTimeout(this.sizetm),void 0!==this.display){void 0===this.sizeel&&(this.sizeel=document.createElement("div"),this.sizeel.className="decafmud note center",this.container.appendChild(this.sizeel));var t=this.display.getSize();this.sizeel.style.cssText="opacity:1",this.sizeel.innerHTML="{0}x{1}".tr(this.decaf,t[0],t[1]);var e=this;this.sizetm=setTimeout((function(){e.hideSize()}),500)}},o.prototype.hideSize=function(e){if(clearTimeout(this.sizetm),!0===e){if(void 0!==this.decaf.telopt[t.TN.NAWS])try{this.decaf.telopt[t.TN.NAWS].send()}catch(t){}return this.container.removeChild(this.sizeel),void(this.sizeel=void 0)}this.sizeel.style.cssText="-webkit-transition: opacity 0.25s linear;",this.sizeel.style.cssText+="-moz-transition: opacity 0.25s linear;",this.sizeel.style.cssText+="-o-transition: opacity 0.25s linear;",this.sizeel.style.cssText+="transition: opacity 0.25s linear;";var i=this;setTimeout((function(){i.sizeel.style.opacity=0}),0),this.sizetm=setTimeout((function(){i.hideSize(!0)}),250)},o.prototype.connected=function(){this.updateIcon(this.ico_connected,"DecafMUD is currently connected.".tr(this.decaf),"","connectivity connected")},o.prototype.connecting=function(){this.updateIcon(this.ico_connected,"DecafMUD is attempting to connect.".tr(this.decaf),"","connectivity connecting")},o.prototype.disconnected=function(){this.updateIcon(this.ico_connected,"DecafMUD is currently disconnected.".tr(this.decaf),"","connectivity disconnected")},o.prototype.unloadPageFromEvent=function(t){return this.decaf.connected?"You are still connected.":void 0},o.prototype.load=function(){this.decaf.require("decafmud.display."+this.decaf.options.display)},o.prototype.reset=function(){this.masked=!1,this.inputCtrl=!1,this.mruIndex=0,this.mruHistory=[],this.mruSize=this.decaf.options.set_interface.mru_size,this.mruTemp=!1,this.hasFocus=!1,this.reqTab=!1,this.wantTab=!1,this.tabIndex=-1,this.tabValues=[],this.buffer="",void 0!==this.input&&this.updateInput(),void 0!==this.display&&this.display.reset()},o.prototype.setup=function(){this.store=this.decaf.store.sub("ui"),this.storage=this.store;var e=this.store.get("toolbar-position","top-left");this.old_tbarpos=e,this.toolbar.className+=" "+e,this.container.insertBefore(this.toolbar,this.container.firstChild);var i=this.decaf.options.display;this.decaf.debugString('Initializing display plugin "'+i+'" in: #'+this.el_display.id,"info"),this.display=new t.plugins.Display[i](this.decaf,this,this.el_display),this.display.id="mud-display",this.decaf.display=this.display,this.goFullOnResize=!1;var s=this.store.get("fullscreen-start",this.decaf.options.set_interface.start_full);this.fsbutton=this.tbNew("Fullscreen".tr(this.decaf),void 0,"Click to enter fullscreen mode.".tr(this.decaf),1,!0,s,void 0,(function(t){this.click_fsbutton(t)})),this.logbutton=this.tbNew("Logs".tr(this.decaf),void 0,"Click to open a window containing this session's logs.".tr(this.decaf),0,!0,!1,void 0,(function(t){this.showLogs()})),this.ico_connected=this.addIcon("You are currently disconnected.".tr(this.decaf),"","connectivity disconnected"),s?this.enter_fs(!1):this._resizeToolbar()||this.resizeScreen(!1)},o.prototype.showLogs=function(){var t="",e="";if(window.getComputedStyle){for(var i=this.display.display,s=0;i;){if((s+=1)>15)return void alert("Too high count!");if((o=getComputedStyle(i,null)).backgroundColor&&"transparent"!==o.backgroundColor&&"rgba("!==o.backgroundColor.substr(0,5)){t="background-color:"+o.backgroundColor+";";break}if(i===document.body)break;i=i.parentNode}var o;t||(t="background-color:#000;"),t="body{"+t+"color:"+(o=getComputedStyle(this.display.display,null)).color+";}",e="div{font-family:"+o.fontFamily+";font-size:"+o.fontSize+";}"}else t="body{background:#000;color:#C0C0C0;}",e="div{font-family:monospace;}";var n="data:text/html,";n+="<html><head><title>",n+="DecafMUD Session Log".tr(this.decaf),n+="</title><style>"+t+e+"</style></head><body>",n+="<h1>",n+="DecafMUD Session Log".tr(this.decaf),n+="</h2>",n+="<div>"+this.display.display.innerHTML+"</div>",n+="</body></html>",window.open(n,"log-window","width=700,height=400,directories=no,location=no,menubar=no,status=no,toolbar=no,scrollbars=yes")},o.prototype.settings=void 0,o.prototype.showSettings=function(){if(this.settings)return this.settings.parentNode.removeChild(this.settings),this.settings=void 0,this.set_cont=void 0,this.tbPressed(this.stbutton,!1),this.tbTooltip(this.stbutton,"Click to change DecafMUD's settings.".tr(this.decaf)),void this.el_display.setAttribute("tabIndex","0");var t=document.createElement("div");t.className="decafmud window settings",this.toolbarPadding&&(t.style.paddingTop=this.toolbarPadding-5+"px");var e=document.createElement("div");e.className="decafmud window-middle",t.appendChild(e);var i=document.createElement("div");i.className="decafmud window-inner",e.appendChild(i);var s=document.createElement("h2");s.innerHTML="DecafMUD Settings".tr(this.decaf),i.appendChild(s);var o=document.createElement("p");for(var n in o.innerHTML="Use the form below to adjust DecafMUD's settings, then click Apply when you're done.".tr(this.decaf),i.appendChild(o),this.decaf.settings){var r=this.decaf.settings[n],a=document.createElement("fieldset");a.className="decafmud settings";var l=n.substr(0,1).toUpperCase()+n.substr(1);void 0!==r._name&&(l=r._name),(p=document.createElement("legend")).innerHTML=l.tr(this.decaf),a.appendChild(p),void 0!==r._desc&&((o=document.createElement("p")).innerHTML=r._desc.tr(this.decaf),a.appendChild(o));var h=r._path||"/";for(var c in"/"!==h.substr(-1)&&(h+="/"),r)if("_"!==c.substr(0,1)){o=document.createElement("div");var d=r[c];l=c.substr(0,1).toUpperCase()+c.substr(1),void 0!==d._name&&(l=d._name);var p,u=h+c,f=d._type||"text";if("boolean"!==f&&((p=document.createElement("label")).setAttribute("for",u),p.innerHTML=l.tr(this.decaf),o.appendChild(p)),"password"===f)(y=document.createElement("input")).setAttribute("id",u),y.setAttribute("type","password"),o.appendChild(y);else if("boolean"===f)(y=document.createElement("input")).setAttribute("id",u),y.setAttribute("type","checkbox"),o.appendChild(y);else if("nochance"===f){(y=document.createElement("select")).setAttribute("id",u);var g=document.createElement("option");g.setAttribute("value","true"),g.innerHTML="Yes",y.appendChild(g),(g=document.createElement("option")).setAttribute("value","false"),g.innerHTML="No",y.appendChild(g),o.appendChild(y)}else(y=document.createElement("input")).setAttribute("id",u),o.appendChild(y);if(void 0!==d._desc)"boolean"===f?(y=document.createElement("label")).setAttribute("for",u):y=document.createElement("p"),y.innerHTML=d._desc.tr(this.decaf),o.appendChild(y);else if("boolean"===f){var y;(y=document.createElement("label")).setAttribute("for",u),y.innerHTML=l.tr(this.decaf),o.appendChild(y)}a.appendChild(o)}i.appendChild(a)}var b=this.container.offsetHeight-(this._input.offsetHeight+17);this.toolbarPadding&&(b-=this.toolbarPadding-12),b<0&&(b=0),e.style.height=b+"px",this.el_display.setAttribute("tabIndex","-1"),this.container.insertBefore(t,this.el_display),this.settings=t,this.set_cont=i,this.set_mid=e,this.tbPressed(this.stbutton,!0),this.tbTooltip(this.stbutton,"Click to close the settings window.".tr(this.decaf))},o.prototype.tbDelete=function(t){if(void 0!==this.toolbuttons[t]){var e=this.toolbuttons[t];e[0].parentNode.removeChild(e[0]),this.toolbuttons[t]=void 0,this._resizeToolbar()}},o.prototype.tbText=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";if(!e)throw"Text can't be empty/false/null/whatever.";i[0].innerHTML=e,void 0===i[3]&&(i[3]=e,i[0].title=e)},o.prototype.tbTooltip=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";i[3]=e,i[0].title=e||i[1]},o.prototype.tbEnabled=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";e=!!e,i[5]=e,i[0].setAttribute("aria-disabled",!e),e?i[0].className=i[0].className.replace(" disabled",""):/disabled/.test(i[0].className)||(i[0].className+=" disabled")},o.prototype.tbPressed=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";e=!!e,i[6]=e,i[0].setAttribute("aria-pressed",e),e?/toggle-depressed/.test(i[0].className)&&(i[0].className=i[0].className.replace(" toggle-depressed"," toggle-pressed")):/toggle-pressed/.test(i[0].className)&&(i[0].className=i[0].className.replace(" toggle-pressed"," toggle-depressed"))},o.prototype.tbClass=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";var s=i[7];i[7]=e,void 0!==s&&(i[0].className=i[0].className.replace(" "+s,"")),e&&(i[0].className+=" "+e)},o.prototype.tbIcon=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";i[2]=e,e?(/ icon/.test(i[0].className)||(i[0].className+=" icon"),i[0].style.cssText="background-image: url("+e+");"):(i[0].className=i[0].className.replace(" icon",""),i[0].style.cssText="")},o.prototype.tbNew=function(t,i,s,o,n,r,a,l){if("function"==typeof i){var h=l;l=i,i=s,s=o,o=n,n=r,r=a,a=h}var c=++this.toolbutton_id,d=document.createElement("a");if(d.id=this.container.id+"-toolbar-button-"+c,d.className="decafmud button toolbar-button",a&&(d.className+=" "+a),1===o&&(d.className+=" toggle "+(r?"toggle-pressed":"toggle-depressed")),d.innerHTML=t,d.title=s||t,!1!==n&&(n=!0),n||(d.className+=" disabled"),d.setAttribute("tabIndex","0"),d.setAttribute("role","button"),d.setAttribute("aria-disabled",!n),1===o&&d.setAttribute("aria-pressed",r),i&&(d.style.cssText="background-image: url("+i+");",d.className+=" icon"),l){var p=this,u=function(t){if("keydown"!==t.type||13===t.keyCode){var e=p.toolbuttons[c];!0===e[5]&&(l.call(p,t),t.type&&"keydown"!==t.type&&e[0].blur())}};e(d,"click",u),e(d,"keydown",u)}return e(d,"focus",(function(t){this.parentNode&&/toolbar/.test(this.parentNode.className)&&(this.parentNode.setAttribute("aria-activedescendant",this.id),this.parentNode.className+=" visible")})),e(d,"blur",(function(t){this.parentNode&&/toolbar/.test(this.parentNode.className)&&(this.parentNode.getAttribute("aria-activedescendant")===this.id&&this.parentNode.setAttribute("aria-activedescendant",""),this.parentNode.className=this.parentNode.className.replace(" visible",""))})),this.toolbuttons[c]=[d,t,i,s,o,n,r,a,l],d.setAttribute("button-id",c),this.toolbar.appendChild(d),this._resizeToolbar(),c},o.prototype.toolbarPadding=void 0,o.prototype._resizeToolbar=function(){var t=this.store.get("toolbar-position","top-left"),e=this.store.get("toolbar-always",2),i=this.toolbar.style.cssText,s=!1;this.old_tbarpos!==t&&(this.toolbar.className=this.toolbar.className.replace(" "+this.old_tbarpos," "+t),i="top-left"===this.old_tbarpos||"top-right"===this.old_tbarpos?i.replace(/top:[\s\-0-9a-z]+;/g,""):"left"===this.old_tbarpos?i.replace(/left:[\s\-0-9a-z]+;/g,""):i.replace(/right:[\s\-0-9a-z]+;/g,""),this.old_tbarpos=t),e=0!==e&&(1===e||-1!==this.container.className.indexOf("fullscreen")),-1===this.toolbar.className.indexOf(" always-on")&&e?this.toolbar.className+=" always-on":-1===this.toolbar.className.indexOf(" always-on")||e||(this.toolbar.className=this.toolbar.className.replace(" always-on","")),/ always-on/.test(this.toolbar.className)&&/ top-(?:left|right)/.test(this.toolbar.className)?(this.settings&&this.toolbarPadding!==this.toolbar.clientHeight&&(this.settings.style.paddingTop=this.toolbar.clientHeight-5+"px"),this.display&&this.toolbarPadding!==this.toolbar.clientHeight?(this.display.shouldScroll(),this.el_display.style.paddingTop=this.toolbar.clientHeight+"px",this.toolbarPadding=this.toolbar.clientHeight,this.resizeScreen(!1,!0),this.display.doScroll(),s=!0):this.toolbarPadding=this.toolbar.clientHeight):void 0!==this.toolbarPadding&&(this.settings&&(this.settings.style.paddingTop=""),this.display&&(this.display.shouldScroll(),this.el_display.style.paddingTop="0px",this.toolbarPadding=void 0,this.resizeScreen(!1,!0),this.display.doScroll(),s=!0));var o=-1*(this.toolbar.clientWidth-15),n=-1*(this.toolbar.clientHeight-12);return i=/ left/.test(this.toolbar.className)?i.replace(/left:[\s\-0-9a-z]+;/g,"")+"left:"+o+"px;":/ right/.test(this.toolbar.className)?i.replace(/right:[\s\-0-9a-z]+;/g,"")+"right:"+o+"px;":i.replace(/top:[\s\-0-9a-z]+;/g,"")+"top:"+n+"px;",this.toolbar.style.cssText=i,s},o.prototype.showScrollButton=function(){if(void 0===this.scrollButton){var t=document.createElement("div"),i=this;t.className="button scroll-button",t.setAttribute("tabIndex",0),t.innerHTML="More".tr(this.decaf);var s=function(t){"keydown"==t.type&&13!==t.keyCode||i.display.scrollNew()};e(t,"click",s),e(t,"keydown",s),this.scrollButton=t,this.container.appendChild(t),t.style.cssText="bottom:"+(this._input.offsetHeight+12)+"px"}},o.prototype.hideScrollButton=function(){void 0!==this.scrollButton&&(this.scrollButton.parentNode.removeChild(this.scrollButton),this.scrollButton=void 0)},o.prototype.infoBar=function(t,e,i,s,o,n,r){if("number"==typeof e){var a=i;i=e,e=a}void 0===e&&(e="info"),void 0===i&&(i=0);var l={text:t,class:e,timeout:i,icon:s,buttons:o,click:n,close:r};this.infobars.push(l),void 0===this.ibar&&this.createIBar()},o.prototype.immediateInfoBar=function(t,e,i,s,o,n,r){return void 0===this.ibar&&(this.infoBar(t,e,i,s,o,n,r),!0)};var n=function(t,i,s){var o=document.createElement("a");o.className="button",o.setAttribute("href","#"),o.setAttribute("onclick","return false;"),o.innerHTML=i[0],e(o,"click",(function(t){return s.closeIBar(!0),setTimeout((function(){i[1].call(s,t)}),0),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!1})),t.appendChild(o)};o.prototype.createIBar=function(){var t=this,i=this.infobars[0],s=document.createElement("div");s.setAttribute("role","alert"),s.className="decafmud infobar "+i.class,s.innerHTML=i.text,s.style.cssText="top: -26px;",void 0!==i.click&&(s.className+=" clickable",s.setAttribute("tabIndex","0"));var o=function(e){void 0===e||"keydown"===e.type&&13!==e.keyCode&&27!==e.keyCode||("click"!==e.type||i.click)&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),t.closeIBar(!0),"keydown"!==e.type||27!==e.keyCode?i.click&&i.click.call(t,e):i.close&&i.close.call(t,e))};e(s,"click",o),e(s,"keydown",o);var r=document.createElement("div");r.innerHTML="X",r.className="close",r.setAttribute("tabIndex","0");var a=function(e){void 0===e||"keydown"===e.type&&13!==e.keyCode||(t.closeIBar(!0),i.close&&i.close.call(t,e),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())};if(e(r,"click",a),e(r,"keydown",a),s.insertBefore(r,s.firstChild),i.buttons){var l=document.createElement("div");l.className="btncont";for(var h=0;h<i.buttons.length;h++)n(l,i.buttons[h],this);s.insertBefore(l,r)}this.ibar=s,i.el=s,this.container.insertBefore(s,this.container.firstChild),setTimeout((function(){var e=0;window.getComputedStyle?e=parseInt(getComputedStyle(s,null).paddingTop):s.currentStyle&&(e=parseInt(s.currentStyle.paddingTop)),t.toolbarPadding&&(e+=t.toolbarPadding-10),s.style.cssText="background-position: 5px "+e+"px;padding-top: "+e+"px;-webkit-transition: top 0.1s linear;-moz-transition: top 0.1s linear;-o-transition: top 0.1s linear;transition: top 0.1s linear; top: inherit",i.icon&&(s.style.cssText+='background-image: url("'+i.icon+'")')}),0),i.timeout>0&&(this.ibartimer=setTimeout((function(){t.closeIBar()}),1e3*i.timeout))},o.prototype.closeIBar=function(t){if(void 0!==this.ibar)if(clearTimeout(this.ibartimer),t)this.ibar.parentNode.removeChild(this.ibar),delete this.ibar,this.infobars.shift(),this.infobars.length>0&&this.createIBar();else{this.ibar.style.cssText+="-webkit-transition: opacity 0.25s linear;-moz-transition: opacity 0.25s linear;-o-transition: opacity 0.25s linear;transition: opacity 0.25s linear; opacity: 0";var e=this;this.ibartimer=setTimeout((function(){e.closeIBar(!0)}),250)}},o.prototype.addIcon=function(t,i,s,o,n){var r=document.createElement("div");r.className="decafmud status-icon "+s+(o?" icon-click":""),r.innerHTML=i,r.setAttribute("title",t),r.setAttribute("role","status"),r.setAttribute("aria-label",t),(o||n)&&r.setAttribute("tabIndex","0");for(var a=this.icons.push([r,o,n])-1,l=0;l<this.icons.length;l++)this.icons[l][0].style.cssText="right:"+21*(this.icons.length-l-1)+"px";this.tray.appendChild(r);var h=this;return o&&e(r,"click",(function(t){o.call(h,t)})),o&&!n&&e(r,"keydown",(function(t){13===t.keyCode&&o.call(h,t)})),n&&e(r,"keydown",(function(t){n.call(h,t)})),this._resizeTray(),a},o.prototype.delIcon=function(t){if(t<0||t>=this.icons.length)throw"Invalid index for icon!";var e=this.icons[t][0];this.icons.splice(t,1),this._input.removeChild(e);for(var i=0;i<this.icons.length;i++)this.icons[i].style.cssText="right:"+21*(this.icons.length-i-1)+"px";this._resizeTray()},o.prototype.updateIcon=function(t,e,i,s){if(t<0||t>=this.icons.length)throw"Invalid index for icon!";var o=this.icons[t],n=o[1];o[2],o=o[0],s&&(o.className="decafmud status-icon "+s+(n?" icon-click":"")),i&&(o.innerHTML=i),e&&(o.setAttribute("title",e),o.setAttribute("aria-label",e))},o.prototype._resizeTray=function(){var t=this.tray.clientWidth;this._input.style.cssText="padding-right:"+t+"px"},o.prototype.click_fsbutton=function(t){-1===this.container.className.indexOf("fullscreen")?this.enter_fs():this.exit_fs()},o.prototype.oldscrollX=void 0,o.prototype.oldscrollY=void 0,o.prototype.old_children=[],o.prototype.old_display=[],o.prototype.enter_fs=function(t){if(-1===this.container.className.indexOf("fullscreen")){var e=this.inpFocus;this.display&&this.display.shouldScroll(!1),this.oldscrollY=window.scrollY,this.oldscrollX=window.scrollX,this.old_parent=this.container.parentNode,this.next_sib=this.container.nextElementSibling,void 0===this.next_sib&&this.container.nextSibling&&this.container.nextSibling.nodeType==this.container.nodeType&&(this.next_sib=this.container.nextSibling),this.old_parent.removeChild(this.container),this.container.className+=" fullscreen",this.tbPressed(this.fsbutton,!0),this.tbTooltip(this.fsbutton,"Click to exit fullscreen mode.".tr(this.decaf));for(var i=0;i<document.body.children.length;i++){var o=document.body.children[i];"_firebugConsole"!==o.id&&0!==o.id.indexOf("DecafFlashSocket")&&(this.old_children.push(o),this.old_display.push(o.style.display),o.style.display="none")}this.old_body_over=document.body.style.overflow,s||(document.body.style.overflow="hidden"),document.body.appendChild(this.container),window.scroll(0,0),this._resizeToolbar(),this.resizeScreen(t,!1),!1!==t&&this.showSize(),e&&this.input.focus(),this.display&&this.display.doScroll()}},o.prototype.exit_fs=function(){if(void 0!==this.old_parent){var t=this.inpFocus;this.display&&this.display.shouldScroll(!1),this.container.parentNode.removeChild(this.container);for(var e=0;e<this.old_children.length;e++)this.old_children[e].style.display=this.old_display[e];this.old_children=[],this.old_display=[];var i=this.container.className.split(" ");for(e=0;e<i.length;)"fullscreen"!==i[e]?e++:i.splice(e,1);this.container.className=i.join(" "),this.tbPressed(this.fsbutton,!1),this.tbTooltip(this.fsbutton,"Click to enter fullscreen mode.".tr(this.decaf)),void 0!==this.next_sib&&null!==this.next_sib?this.old_parent.insertBefore(this.container,this.next_sib):this.old_parent.appendChild(this.container),document.body.style.overflow=this.old_body_over,window.scroll(this.oldscrollX,this.oldscrollY),this._resizeToolbar(),this.showSize(),t&&this.input.focus(),this.display&&this.display.doScroll()}},o.prototype.old_height=-1,o.prototype.old_width=-1,o.prototype.old_fs=!1,o.prototype.goFullOnResize=!0,o.prototype.resizeScreen=function(t,e){if(this.goFullOnResize){var i=!0===window.fullScreen;if(i||(window.outerHeight?i=window.screen.height-window.outerHeight<=5:window.innerHeight&&(i=window.screen.height-window.innerHeight<=5)),i&&!this.old_fs)return this.old_fs=i,void this.enter_fs();if(!i&&this.old_fs)return this.old_fs=i,void this.exit_fs();this.old_fs=i}if(!0===e||this.old_height!==this.container.offsetHeight||this.old_width!==this.container.offsetWidth){this.old_height=this.container.offsetHeight,this.old_width=this.container.offsetWidth;var s=this.old_height-(this._input.offsetHeight+17);this.toolbarPadding&&(s-=this.toolbarPadding-12),s<0&&(s=0),this.settings&&(this.set_mid.style.height=s+"px"),this.toolbarPadding&&(s-=12)<0&&(s=0),this.el_display.style.height=s+"px",!0!==e&&this.display&&this.display.scroll(),this.scrollButton&&(this.scrollButton.style.cssText="bottom:"+(this._input.offsetHeight+12)+"px"),!1!==t&&this.showSize()}},o.prototype.resizeScreenFromEvent=function(t,e){this.resizeScreen(!0,!1)},o.prototype.displayInput=function(t){this.display&&this.echo&&this.display.message('<span class="command">'+t+"</span>","user-input",!1)},o.prototype.localEcho=function(t){t!==this.echo&&(this.echo=t,this.updateInput())},o.prototype.displayKey=function(t){t.altKey||t.ctrlKey||t.metaKey||(t.keyCode>64&&t.keyCode<91||t.keyCode>47&&t.keyCode<58||t.keyCode>185&&t.keyCode<193||t.keyCode>218&&t.keyCode<223)&&this.input.focus()},o.prototype.handleInputPassword=function(t){13===t.keyCode&&(this.inpFocus=!0,this.decaf.sendInput(this.input.value),this.input.value="")},o.prototype.saveInputInHistory=function(){if(txt=this.input.value,""!=txt&&txt!=this.history[0]){var t=-1;for(i=0;i<this.history.length;i++)if(this.history[i]==txt){t=i;break}for(-1==t&&(t=this.history.length-1),i=t;i>0;i--)this.history[i]=this.history[i-1];this.history[0]=txt}},o.prototype.inputModified=function(){return txt=this.input.value,-1==this.historyposition?""!==txt:txt!==this.history[this.historyPosition]},o.prototype.loadInput=function(){-1==this.historyPosition?this.input.value="":(this.input.focus(),this.input.value=this.history[this.historyPosition])},o.prototype.parseInput=function(t){lines=t.split(";;");for(var e=0,i=lines.length;e<i;e++)this.decaf.sendInput(lines[e])},o.prototype.handleInput=function(t){"keydown"===t.type&&(112!=t.keyCode&&116!==t.keyCode||t.preventDefault(),13===t.keyCode?(this.parseInput(this.input.value),this.saveInputInHistory(),this.historyPosition=0,this.decaf.options.set_interface.repeat_input||(this.input.value=""),this.input.select()):void 0!==window.tryExtraMacro&&tryExtraMacro(this.decaf,t.keyCode)?t.preventDefault?t.preventDefault():t.returnValue=!1:33===t.keyCode?this.display&&this.display.scrollUp&&(this.display.scrollUp(),t.preventDefault()):34===t.keyCode?this.display&&this.display.scrollDown&&(this.display.scrollDown(),t.preventDefault()):40==t.keyCode?(this.inputModified()&&(this.historyPosition=-1),-1==this.historyPosition?this.saveInputInHistory():0==this.historyPosition?this.historyPosition=-1:this.historyPosition=this.historyPosition-1,this.loadInput()):38==t.keyCode?(this.inputModified()&&(this.historyPosition=-1),-1==this.historyPosition?""==this.input.value?this.historyPosition=0:(this.saveInputInHistory(),this.historyPosition=1):this.historyPosition<this.history.length-1&&(this.historyPosition=this.historyPosition+1),this.loadInput()):8==t.keyCode&&!0===t.shiftKey&&(this.input.value=""))},o.prototype.handleBlur=function(t){var e=this.input,i=this.decaf.options.set_interface.blurclass;if("blur"===t.type){""===e.value&&(e.className+=" "+i);var s=this;setTimeout((function(){s.settings&&(s.settings.style.top="0px",s.set_mid.style.overflowY="scroll")}),100),this.inpFocus=!1}else if("focus"===t.type){for(var o=e.className.split(" "),n=[],r=0;r<o.length;r++)o[r]!==i&&n.push(o[r]);if(e.className=n.join(" "),this.settings){var a=.5*this.settings.clientHeight*-1;this.settings.style.top=a+"px",this.set_mid.style.overflowY="hidden"}this.inpFocus=!0}},o.prototype.updateInput=function(t){if(this.input){var i,o=this.inpFocus,n=this,r=this.input;if(i="TEXTAREA"===this.input.tagName?"text":r.type,!0===t||!(!this.echo&&"password"===i||this.echo&&"password"!==i)){var a,l=r.className,h=r.getAttribute("style"),c=r.id,d=r.parentNode;if(void 0===(a=r.nextElementSibling)&&r.nextSibling&&r.nextSibling.nodeType===r.nodeType&&(a=r.nextSibling),this.echo){var p=1;this.inp_buffer&&(p=this.inp_buffer.substr_count("\n")+1),1===p?(u=document.createElement("input")).type="text":(u=document.createElement("textarea"),s?u.setAttribute("rows",p-1):u.setAttribute("rows",p)),l&&(u.className=l),h&&u.setAttribute("style",h),this.inp_buffer&&(u.value=this.inp_buffer),d.removeChild(r),delete this.input,c&&(u.id=c),a?d.insertBefore(u,a):d.appendChild(u),this.input=u,e(u,"keydown",(function(t){n.handleInput(t)}))}else{var u;this.inp_buffer=r.value,(u=document.createElement("input")).type="password",l&&(u.className=l),h&&u.setAttribute("style",h),d.removeChild(r),delete this.input,c&&(u.id=c),a?d.insertBefore(u,a):d.appendChild(u),this.input=u,e(u,"keydown",(function(t){n.handleInputPassword(t)}))}this.inpFocus=o;var f=function(t){n.handleBlur(t)};e(this.input,"blur",f),e(this.input,"focus",f),this.inpFocus&&setTimeout((function(){n.input.select(),n.input.focus()}),1)}}},t.plugins.Interface.simple=o}(DecafMUD)},164:()=>{function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}void 0===String.prototype.endsWith&&(String.prototype.endsWith=function(t){var e=this.length-t.length;return!(e<0)&&this.lastIndexOf(t,e)===e}),void 0===String.prototype.substr_count&&(String.prototype.substr_count=function(t){for(var e=0,i=this.indexOf(t);-1!==i;)e++,i=this.indexOf(t,i+1);return e}),void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(t,e){for(void 0===e&&(e=0);e<this.length;e++)if(this[e]===t)return e;return-1}),function(e){var i=function e(i,s){for(var o in s){var n=s[o];if("object"!==t(n)||"nodeType"in n)i[o]=n;else if(void 0!==n.push){void 0===i[o]&&(i[o]=[]);for(var r=0;r<n.length;r++)i[o].push(n[r])}else void 0===i[o]&&(i[o]={}),"object"===t(i[o])&&e(i[o],n)}return i},s=function s(o){if(this.options={},i(this.options,s.options),void 0!==o){if("object"!==t(o))throw"The DecafMUD options argument must be an object!";i(this.options,o)}if(this.settings={},i(this.settings,s.settings),this.need=[],this.inbuf=[],this.telopt={},"autodetect"===this.options.language){var n=navigator.language?navigator.language:navigator.userLanguage;this.options.language=n.split("-",1)[0]}return this.id=++s.last_id,s.instances.push(this),this.debugString("Created new instance.","info"),"console"in e&&console.groupCollapsed&&(console.groupCollapsed("DecafMUD["+this.id+"] Provided Options"),console.dir(this.options),console.groupEnd()),"en"!==this.options.language&&this.options.load_language&&this.require("decafmud.language."+this.options.language),this.require("decafmud.interface."+this.options.interface),this.waitLoad(this.initSplash),this};s.instances=[],s.last_id=-1,s.version={major:0,minor:9,micro:1,flag:"beta",toString:function(){return this.major+"."+this.minor+"."+this.micro+(this.flag?"-"+this.flag:"")}},s.prototype.loaded=!1,s.prototype.connecting=!1,s.prototype.connected=!1,s.prototype.loadTimer=null,s.prototype.timer=null,s.prototype.connect_try=0,s.prototype.required=0,(s.plugins={Display:{},Encoding:{},Extra:{},Interface:{},Language:{},Socket:{},Storage:{},Telopt:{}}).Encoding.iso88591={proper:"ISO-8859-1",decode:function(t){return[t,""]},encode:function(t){return t}},s.plugins.Encoding.utf8={proper:"UTF-8",decode:function(t){try{return[decodeURIComponent(escape(t)),""]}catch(n){for(var e="",i=0,s=t.length,o=c2=c3=c4=0;i<s;)if((o=t.charCodeAt(i++))<128)e+=String.fromCharCode(o);else if(o>191&&o<224){if(i+1>=s)break;e+=String.fromCharCode((31&o)<<6|63&t.charCodeAt(i++))}else if(o>223&&o<240){if(i+2>=s)break;e+=String.fromCharCode((15&o)<<12|(63&t.charCodeAt(i++))<<6|63&t.charCodeAt(i++))}else if(o>239&&o<245){if(i+3>=s)break;e+=String.fromCharCode((10&o)<<18|(63&t.charCodeAt(i++))<<12|(63&t.charCodeAt(i++))<<6|63&t.charCodeAt(i++))}else e+=String.fromCharCode(o);return[e,t.substr(i)]}},encode:function(t){try{return unescape(encodeURIComponent(t))}catch(e){return console.dir(e),t}}},s.prototype.loaded_plugs={},s.ESC="",s.BEL="";var o=s.TN={IAC:"Ã¿",DONT:"Ã¾",DO:"Ã½",WONT:"Ã¼",WILL:"Ã»",SB:"Ãº",SE:"Ã°",IS:"\0",EORc:"Ã¯",GA:"Ã¹",BINARY:"\0",ECHO:"",SUPGA:"",STATUS:"",SENDLOC:"",TTYPE:"",EOR:"",NAWS:"",TSPEED:" ",RFLOW:"!",LINEMODE:'"',AUTH:"#",NEWENV:"'",CHARSET:"*",MSDP:"E",MSSP:"F",COMPRESS:"U",COMPRESSv2:"V",MSP:"Z",MXP:"[",ZMP:"]",CONQUEST:"^",ATCP:"Ãˆ",GMCP:"Ã‰"},n=function(t){var e=s.TN;switch(t){case e.IAC:return"IAC";case e.DONT:return"DONT";case e.DO:return"DO";case e.WONT:return"WONT";case e.WILL:return"WILL";case e.SB:return"SB";case e.SE:return"SE";case e.BINARY:return"TRANSMIT-BINARY";case e.ECHO:return"ECHO";case e.SUPGA:return"SUPPRESS-GO-AHEAD";case e.STATUS:return"STATUS";case e.SENDLOC:return"SEND-LOCATION";case e.TTYPE:return"TERMINAL-TYPE";case e.EOR:return"END-OF-RECORD";case e.NAWS:return"NEGOTIATE-ABOUT-WINDOW-SIZE";case e.TSPEED:return"TERMINAL-SPEED";case e.RFLOW:return"REMOTE-FLOW-CONTROL";case e.AUTH:return"AUTH";case e.LINEMODE:return"LINEMODE";case e.NEWENV:return"NEW-ENVIRON";case e.CHARSET:return"CHARSET";case e.MSDP:return"MSDP";case e.MSSP:return"MSSP";case e.COMPRESS:return"COMPRESS";case e.COMPRESSv2:return"COMPRESSv2";case e.MSP:return"MSP";case e.MXP:return"MXP";case e.ZMP:return"ZMP";case e.CONQUEST:return"CONQUEST-PROPRIETARY";case e.ATCP:return"ATCP";case e.GMCP:return"GMCP"}return(t=t.charCodeAt(0))>15?t.toString(16):"0"+t.toString(16)};s.debugIAC=function(t){for(var e="",i=s.TN,o=0,r=!1,a=t.length,l=n,h=0;h<a;h++){var c=t.charAt(h),d=c.charCodeAt(0);2!==o?3!==o&&4!==o?5!==o?(6===o?c===i.IAC||d>0&&d<8?(r&&(r=!1,e+='" '),c===i.IAC?(e+="IAC ",o=0):1===d?e+="REQUEST ":2===d?e+="ACCEPTED ":3===d?e+="REJECTED ":4===d?e+="TTABLE-IS ":5===d?e+="TTABLE-REJECTED ":6===d?e+="TTABLE-ACK ":7===d&&(e+="TTABLE-NAK ")):(r||(r=!0,e+='"'),e+=c):7===o?c===i.IAC||0===d?(r&&(r=!1,e+='" '),c===i.IAC?(e+="IAC ",o=0):0===d&&(e+="NUL ")):(r||(r=!0,e+='"'),e+=c):o<2&&(e+=l(c)+" "),0===o?c===i.SB&&(o=1):1===o&&(o=c===i.TTYPE||c===i.TSPEED?2:c===i.MSSP?3:c===i.MSDP?4:c===i.NAWS?5:c===i.CHARSET||c===i.SENDLOC||c===i.GMCP?6:c===i.ZMP?7:0)):c===i.IAC?(r=!1,e+="IAC ",o=0):!1===r?r=255*d:(e+=(d+r).toString()+" ",r=!1):c===i.IAC||d>=1&&d<=4?(r&&(r=!1,e+='" '),c===i.IAC?(e+="IAC ",o=0):3===d?e+="MSDP_OPEN ":4===d?e+="MSDP_CLOSE ":(e+=3===o?"MSSP_":"MSDP_",e+=1===d?"VAR ":"VAL ")):(r||(r=!0,e+='"'),e+=c):c===i.ECHO?e+="SEND ":c===i.IS?e+="IS ":c===i.IAC?(r?(r=!1,e+='" IAC '):e+="IAC ",o=0):(r||(r=!0,e+='"'),e+=c)}return e.substr(0,e.length-1)};var r=function(t){this.decaf=t};r.prototype.current=-1,r.prototype._dont=r.prototype.disconnect=function(){this.current=-1},r.prototype._sb=function(t){if(t===o.ECHO)return this.current=(this.current+1)%this.decaf.options.ttypes.length,this.decaf.debugString("RCVD "+s.debugIAC(o.IAC+o.SB+o.TTYPE+o.ECHO+o.IAC+o.SE)),this.decaf.sendIAC(o.IAC+o.SB+o.TTYPE+o.IS+this.decaf.options.ttypes[this.current]+o.IAC+o.SE),!1},s.plugins.Telopt[o.TTYPE]=r;var a=function(t){this.decaf=t};a.prototype._will=function(){this.decaf.ui&&this.decaf.ui.localEcho(!1)},a.prototype._wont=a.prototype.disconnect=function(){this.decaf.ui&&this.decaf.ui.localEcho(!0)},s.plugins.Telopt[o.ECHO]=a;var l=function(t){this.decaf=t};l.prototype.enabled=!1,l.prototype.last=void 0,l.prototype._do=function(){this.last=void 0,this.enabled=!0;var t=this;setTimeout((function(){t.send()}),0)},l.prototype._dont=l.prototype.disconnect=function(){this.enabled=!1},l.prototype.send=function(){if(this.decaf.display&&this.enabled){var t=this.decaf.display.getSize();if(void 0===this.last||this.last[0]!=t[0]||this.last[1]!=t[1]){this.last=t;var e=String.fromCharCode(Math.floor(t[0]/255));e+=String.fromCharCode(t[0]%255),e+=String.fromCharCode(Math.floor(t[1]/255)),e+=String.fromCharCode(t[1]%255),e=o.IAC+o.SB+o.NAWS+e.replace(/\xFF/g,"Ã¿Ã¿")+o.IAC+o.SE,this.decaf.sendIAC(e)}}},s.plugins.Telopt[o.NAWS]=l;var h=function(t){this.decaf=t};h.prototype._dont=function(){return!1},h.prototype._will=function(){var t=this;setTimeout((function(){var e=[],i=[];"iso88591"!==(r=this.decaf.options.encoding)&&void 0!==s.plugins.Encoding[r]&&void 0!==s.plugins.Encoding[r].proper&&(e.push(s.plugins.Encoding[r].proper),i.push(r));for(var n=0;n<this.decaf.options.encoding_order.length;n++){var r=this.decaf.options.encoding_order[n];void 0!==s.plugins.Encoding[r]&&void 0!==s.plugins.Encoding[r].proper&&-1===i.indexOf(r)&&(e.push(s.plugins.Encoding[r].proper),i.push(r))}for(var a in s.plugins.Encoding)-1===i.indexOf(a)&&void 0!==s.plugins.Encoding[a].proper&&e.push(s.plugins.Encoding[a].proper);t.decaf.sendIAC(o.IAC+o.SB+o.CHARSET+o.ECHO+" "+e.join(" ")+o.IAC+o.SE)}),0)},h.prototype._sb=function(t){if(this.decaf.debugString("RCVD "+s.debugIAC(o.IAC+o.SB+o.CHARSET+t+o.IAC+o.SE)),1===t.charCodeAt(0)){0===(t=t.substr(1)).indexOf("TTABLE ")&&(t=t.substr(8));var e=t.charAt(0);t=t.substr(1).split(e);for(var i,n=void 0,r=0;r<t.length;r++){for(var a in i=t[r],s.plugins.Encoding)if(i===a||i===s.plugins.Encoding[a].proper){n=a;break}if(n)break}void 0!==n?(this.decaf.setEncoding(n),this.decaf.sendIAC(o.IAC+o.SB+o.CHARSET+""+i+o.IAC+o.SE)):(this.decaf.debugString("No encoder for: "+t.join(e)),this.decaf.sendIAC(o.IAC+o.SB+o.CHARSET+""+o.IAC+o.SE))}else if(2===t.charCodeAt(0)){for(var a in t=t.substr(1),n=void 0,s.plugins.Encoding)if(s.plugins.Encoding[a].proper===t){n=a;break}void 0!==n&&this.decaf.setEncoding(n)}return!1},s.plugins.Telopt[o.CHARSET]=h;var c=/[\x01\x02\x03\x04]/,d=function e(i){for(var s={},o=void 0;i.length>0;){var n=i.charCodeAt(0);if(1!==n){if(4===n){i=i.substr(1);break}if(void 0===o)return[s,""];if(2!==n)break;if(3===i.charCodeAt(1)){var r=e(i.substr(2));a=r[0],i=r[1]}else{var a="";-1===(l=i.substr(1).search(c))?(a=i.substr(1),i=""):(a=i.substr(1,l),i=i.substr(l+1))}void 0===s[o]?s[o]=a:"object"===t(s[o])&&void 0!==s[o].push?s[o].push(a):s[o]=[s[o],a]}else{var l;-1===(l=i.substr(1).search(c))?(o=i.substr(1),i=""):(o=i.substr(1,l),i=i.substr(l+1)),s[o]=void 0}}return[s,i]},p=function e(i){var s=t(i);if("string"===s||"number"===s)return i.toString();if("boolean"===s)return i?"1":"0";if("undefined"===s)return"";if("object"===s){var o="";for(var n in i)if(void 0!==i[n]&&null!==i[n]&&"function"!=typeof i[n])if(o+=""+n,"object"===t(i[n]))if(void 0!==i[n].push)for(var r=i[n],a=i[n].length,l=0;l<a;l++)o+=""+e(r[l]);else void 0===i[n].nodeType&&(o+=""+e(i[n])+"");else o+=""+e(i[n]);return o}return i.toString()},u=function(t){this.decaf=t};u.prototype.connect=function(){this.commands=["LIST"],this.variables=[],this.reportable=[]},u.config_vars={CLIENT_NAME:"decafmud",CLIENT_VERSION:s.version.toString(),PLUGIN_ID:"0",ANSI_COLORS:"1",UTF_8:"1",XTERM_256_COLORS:"1"},u.prototype._will=function(){var t=this;setTimeout((function(){t.decaf.sendIAC(o.IAC+o.SB+o.MSDP+"LISTCOMMANDS"+o.IAC+o.SE),t.decaf.sendIAC(o.IAC+o.SB+o.MSDP+"LISTVARIABLES"+o.IAC+o.SE),t.decaf.sendIAC(o.IAC+o.SB+o.MSDP+"LISTCONFIGURABLE_VARIABLES"+o.IAC+o.SE),t.decaf.sendIAC(o.IAC+o.SB+o.MSDP+"LISTREPORTABLE_VARIABLES"+o.IAC+o.SE)}),0)},u.prototype._sb=function(t){var i=d(t)[0],s=!1;if("console"in e&&console.groupCollapsed?(console.groupCollapsed("DecafMUD["+this.decaf.id+"]: RCVD IAC SB MSDP ... IAC SE"),console.dir(i),console.groupEnd("DecafMUD["+this.decaf.id+"]: RCVD IAC SB MSDP ... IAC SE")):s=!0,void 0!==i.COMMANDS)for(var n=0;n<i.COMMANDS.length;n++)this.commands.push(i.COMMANDS[n]);if(void 0!==i.VARIABLES)for(n=0;n<i.VARIABLES.length;n++)this.variables.push(i.VARIABLES[n]);if(void 0!==i.CONFIGURABLE_VARIABLES){var r=i.CONFIGURABLE_VARIABLES,a={};for(n=0;n<r.length;n++)void 0!==u.config_vars[r[n]]&&(a[r[n]]=u.config_vars[r[n]]);this.decaf.sendIAC(o.IAC+o.SB+o.MSDP+p(a)+o.IAC+o.SE)}return s},s.plugins.Telopt[o.MSDP]=u,s.plugins.Telopt[o.BINARY]=!0,s.plugins.Telopt[o.MSSP]="console"in e,void 0===String.prototype.tr&&(String.logNonTranslated="console"in e,String.prototype.tr=function(){var e,i,o,n;if(arguments.length>0&&arguments[0]instanceof s?(e=arguments[0],i=1):(e=s.instances[s.instances.length-1],i=0),"en"===(n=e.options.language))o=this;else if(!s.plugins.Language[n]||!(o=s.plugins.Language[n][this])){if(String.logNonTranslated){var r=s.plugins.Language[n]&&void 0!==s.plugins.Language[n].English?s.plugins.Language[n].English:'"'+n+'"';console.warn("DecafMUD["+e.id+"] i18n: No "+r+" translation for: "+this.replace(/\n/g,"\\n"))}o=this}if(arguments.length-i==1&&"object"===t(arguments[i])){var a=arguments[i];for(var l in a)o=o.replace("{"+l+"}",a[l])}else a=arguments,o=o.replace(/{(\d+)}/g,(function(t){var e=parseInt(t[1])+i;return e<a.length?a[e]:""}));return o}),s.prototype.about=function(){var t=["DecafMUD v{0} Â© 2010 Stendec"];t.push("http://decafmud.stendec.me/\n"),t.push("Updated and improved by Pit from Discworld."),t.push("Further bugfixes and improvements by Waba from MUME."),t.push("https://github.com/waba4mume/DecafMUD\n"),t.push("DecafMUD is a web-based MUD client written in JavaScript, rather than a plugin like Flash or Java, making it load faster and react as you'd expect a website to.\n"),t.push("It's easy to customize as well, using simple CSS and JavaScript, and free to use and modify, so long as your MU* is free to play!"),alert(t.join("\n").tr(this,s.version.toString()))},s.prototype.debugString=function(t,i,s){if(!(!1 in e)&&(void 0===i&&(i="debug"),void 0!==s&&(t=t.tr(this,s)),"console"in e)){var o="DecafMUD[%d]: %s";switch(i){case"info":return void console.info(o,this.id,t);case"warn":return void console.warn(o,this.id,t);case"error":return void console.error(o,this.id,t);default:if("debug"in console)return void console.debug(o,this.id,t);console.log(o,this.id,t)}}},s.prototype.error=function(t){this.debugString(t,"error"),"console"in e&&void 0!==console.groupCollapsed&&(console.groupCollapsed("DecafMUD["+this.id+"] Instance State"),console.dir(this),console.groupEnd()),this.ui&&this.ui.splashError(t)||alert("DecafMUD Error\n\n{0}".tr(this,t))},s.prototype.loadScript=function(t,e){if(void 0===e&&(void 0!==this.options.jslocation&&(e=this.options.jslocation),void 0===e||"string"==typeof e&&0===e.length)){var i=document.querySelector('script[src*="decafmud.js"]');null===i&&(i=document.querySelector('script[src*="decafmud.min.js"]')),null!==i&&(e=i.src.substr(0,i.src.lastIndexOf("/")+1))}var s=document.createElement("script");s.type="text/javascript",s.src=e+t,document.getElementsByTagName("head")[0].appendChild(s),this.debugString("Loading script: "+t)},s.prototype.require=function(t,e){if(this.options.load_language&&"en"!==this.options.language&&-1===t.indexOf("language")&&-1!==t.indexOf("decafmud")&&((i=t.split(".")).splice(1,0,"language",this.options.language),this.require(i.join("."))),void 0===e){if(0!==t.toLowerCase().indexOf("decafmud"))throw"Can't build checker for non-DecafMUD module!";var i;if((i=t.split(".")).length<2)return;if(i.shift(),i[0]=i[0][0].toUpperCase()+i[0].substr(1),"Telopt"===i[0])for(var o in s.TN)if(i[1].toUpperCase()===o.toUpperCase()){i[1]=s.TN[o];break}e=function(){return!(void 0===s.plugins[i[0]]||i.length>1&&void 0===s.plugins[i[0]][i[1]])}}this.required++,e.call(this)||(this.loadScript(t+".js"),this.need.push([t,e]))},s.prototype.waitLoad=function(t,e,i){if(clearTimeout(this.loadTimer),void 0===i)i=0;else if(i>this.options.wait_tries){if(-1===this.need[0][0].indexOf("language"))return void this.error("Timed out attempting to load the module: {0}".tr(this,this.need[0][0]));void 0!==e&&(this.need.length>1?e.call(this,this.need[0][0],this.need[1][0]):e.call(this,this.need[0][0])),this.need.shift(),i=0}for(;this.need.length;)if("string"==typeof this.need[0])this.need.shift();else{if(!this.need[0][1].call(this))break;void 0!==e&&(this.need.length>1?e.call(this,this.need[0][0],this.need[1][0]):e.call(this,this.need[0][0])),this.need.shift(),i=0}if(0===this.need.length)t.call(this);else{var s=this;this.loadTimer=setTimeout((function(){s.waitLoad(t,e,i+1)}),this.options.wait_delay)}},s.prototype.initSplash=function(){void 0!==this.options.interface&&(this.debugString('Attempting to initialize the interface plugin "{0}".'.tr(this,this.options.interface)),this.ui=new s.plugins.Interface[this.options.interface](this),this.ui.initSplash()),this.extra=3,this.require("decafmud.storage."+this.options.storage),this.require("decafmud.socket."+this.options.socket),this.require("decafmud.encoding."+this.options.encoding),this.ui&&this.need.length>0&&this.updateSplash(null,this.need[0][0],0),this.waitLoad(this.initSocket,this.updateSplash)},s.prototype.updateSplash=function(t,e,i){if(this.ui){if(void 0===i&&(i=Math.min(100,Math.floor((this.extra+this.required-this.need.length)/(this.required+this.extra)*100))),!0===t);else if(void 0!==e)if(0===e.indexOf("decafmud")){var s=e.split(".");e='Loading the {0} module "{1}"...'.tr(this,s[1],s[2])}else e="Loading: {0}".tr(this,e);else 100==i&&(e="Loading complete.".tr(this));this.ui.updateSplash(i,e)}},s.prototype.initSocket=function(){this.extra=1,this.store=new s.plugins.Storage[this.options.storage](this),this.storage=this.store,this.ui&&(this.need.push("."),this.updateSplash(!0,"Initializing the user interface...".tr(this)),this.ui.load()),this.debugString('Creating a socket using the "{0}" plugin.'.tr(this,this.options.socket)),this.socket=new s.plugins.Socket[this.options.socket](this),this.socket.setup(0),this.waitLoad(this.initUI,this.updateSplash)},s.prototype.initUI=function(){this.ui&&this.ui.setup();for(var t=0;t<this.options.plugins.length;t++)this.require("decafmud."+this.options.plugins[t]);this.waitLoad(this.initFinal,this.updateSplash)},s.prototype.initFinal=function(){for(var t in this.need.push("."),this.updateSplash(!0,"Initializing triggers system..."),this.need.shift(),this.need.push("."),this.updateSplash(!0,"Initializing TELNET extensions..."),s.plugins.Telopt){var e=s.plugins.Telopt[t];this.telopt[t]="function"==typeof e?new e(this):e}this.loaded=!0,this.ui.endSplash(),this.options.autoconnect&&this.socket.ready&&this.connect()},s.prototype.connect=function(){if(!this.connecting&&!this.connected){if(!0!==this.socket_ready)throw"The socket isn't ready yet.";this.connecting=!0,this.connect_try=0,this.debugString("Attempting to connect...","info"),this.ui&&this.ui.connecting&&this.ui.connecting();var t=this;this.conn_timer=setTimeout((function(){t.connectFail()}),this.options.connect_timeout),this.socket.connect()}},s.prototype.connectFail=function(){if(clearTimeout(this.conn_timer),this.cconnect_try+=1,!(this.connect_try>this.options.reconnect_tries)){this.socket.close(),this.socket.connect();var t=this;this.conn_timer=setTimeout((function(){t.connectFail()}),this.options.connect_timeout)}},s.prototype.reconnect=function(){this.connect_try++;var t=this;t.ui&&t.ui.connecting&&t.ui.connecting(),t.socket.connect()},s.prototype.socketReady=function(){this.debugString("The socket is ready."),this.socket_ready=!0,this.loaded&&this.options.autoconnect&&this.connect()},s.prototype.socketConnected=function(){this.connecting=!1,this.connected=!0,this.connect_try=0,clearTimeout(this.conn_timer);var t=this.socket.host,e=this.socket.port;for(var i in this.debugString("The socket has connected successfully to {0}:{1}.".tr(this,t,e),"info"),this.telopt)this.telopt[i]&&this.telopt[i].connect&&this.telopt[i].connect();this.ui&&this.ui.connected&&this.ui.connected()},s.prototype.socketClosed=function(){for(var t in clearTimeout(this.conn_timer),this.connecting=!1,this.connected=!1,this.debugString("The socket has disconnected.","info"),this.telopt)this.telopt[t]&&this.telopt[t].disconnect&&this.telopt[t].disconnect();if(this.inbuf=[],this.options.autoreconnect&&(this.connect_try++,this.connect_try<this.options.reconnect_tries)){this.ui&&this.ui.disconnected&&this.ui.disconnected(!0);var e=this,i=this.options.reconnect_delay/1e3;return this.ui&&this.ui.immediateInfoBar&&i>=.25&&this.ui.immediateInfoBar("You have been disconnected. Reconnecting in {0} second{1}...".tr(this,i,1===i?"":"s"),"reconnecting",i,void 0,[["Reconnect Now".tr(this),function(){clearTimeout(e.timer),e.socket.connect()}]],void 0,(function(){clearTimeout(e.timer)})),void(this.timer=setTimeout((function(){e.debugString("Attempting to connect...","info"),e.ui&&e.ui.connecting&&e.ui.connecting(),e.socket.connect()}),this.options.reconnect_delay))}this.ui&&this.ui.disconnected&&this.ui.disconnected(!1)},s.prototype.socketData=function(t){this.inbuf.push(t),this.loaded&&this.processBuffer()},s.prototype.socketError=function(t,e){this.debugString('Socket Err: {0}  d2="{1}"'.tr(this,t,e),"error")},s.prototype.getEnc=function(t){return t.replace(/-/g,"").toLowerCase()},s.prototype.setEncoding=function(t){if(t=this.getEnc(t),void 0===s.plugins.Encoding[t])throw'"'+t+"' isn't a valid encoding scheme, or it isn't loaded.";this.debugString("Switching to character encoding: "+t),this.options.encoding=t,this.decode=s.plugins.Encoding[t].decode,this.encode=s.plugins.Encoding[t].encode};var f=/\xFF/g;s.prototype.sendInput=function(t){this.socket&&this.socket.connected?(this.socket.write(this.encode(t+"\r\n").replace(f,"Ã¿Ã¿")),this.ui&&this.ui.displayInput(t)):this.debugString("Cannot send input: not connected")},s.prototype.decode=function(t){return s.plugins.Encoding[this.options.encoding].decode(t)},s.prototype.encode=function(t){return s.plugins.Encoding[this.options.encoding].encode(t)},s.prototype.processBuffer=function(){if(this.display){var t=this.inbuf.join(""),e=s.TN.IAC,i="";for(this.inbuf=[];t.length>0;){var o=t.indexOf(e);if(-1===o){var n=this.decode(t);this.display.handleData(n[0]),this.inbuf.splice(1,0,n[1]);break}o>0&&(n=this.decode(t.substr(0,o)),this.display.handleData(n[0]),i=n[1],t=t.substr(o));var r=this.readIAC(t);if(!1===r){this.inbuf.splice(1,0,i+t);break}t=i+r}}},s.prototype.readIAC=function(t){if(t.length<2)return!1;if(255===t.charCodeAt(1))return this.display.handleData("Ã¿"),t.substr(2);if(249===t.charCodeAt(1)||241===t.charCodeAt(1))return t.substr(2);if(-1!=="Ã»Ã¼Ã½Ã¾".indexOf(t.charAt(1))){if(t.length<3)return!1;var e=t.substr(0,3);return this.debugString("RCVD "+s.debugIAC(e)),this.handleIACSimple(e),t.substr(3)}if(t.charAt(1)===o.SB){e="";var i=o.IAC+o.SE,n=t.charAt(2);if(0===(t=t.substr(3)).length)return!1;for(;t.length>0;){var r=t.indexOf(i);if(-1===r)return!1;if(!(r>0&&t.charAt(r-1)===o.IAC)){e+=t.substr(0,r),t=t.substr(r+1);break}e+=t.substr(0,r+1),t=t.substr(r+1)}var a=!0;void 0!==this.telopt[n]&&void 0!==this.telopt[n]._sb&&!1===this.telopt[n]._sb(e)&&(a=!1),a&&(n===o.MSSP&&void 0!==console.groupCollapsed?(console.groupCollapsed("DecafMUD["+this.id+"]: RCVD IAC SB MSSP ... IAC SE"),console.dir(d(e)[0]),console.groupEnd("DecafMUD["+this.id+"]: RCVD IAC SB MSSP ... IAC SE")):this.debugString("RCVD "+s.debugIAC(o.IAC+o.SB+n+e+o.IAC+o.SE)))}return t.substr(1)},s.prototype.sendIAC=function(t){this.debugString("SENT "+s.debugIAC(t)),this.socket&&this.socket.write(t)},s.prototype.handleIACSimple=function(t){var e=s.TN,i=this.telopt[t.charAt(2)],o=t.charAt(2);if(void 0!==i)switch(t.charAt(1)){case e.DO:return void(i._do&&!1===i._do()||this.sendIAC(e.IAC+e.WILL+o));case e.DONT:return void(i._dont&&!1===i._dont()||this.sendIAC(e.IAC+e.WONT+o));case e.WILL:return void(i._will&&!1===i._will()||this.sendIAC(e.IAC+e.DO+o));case e.WONT:return void(i._wont&&!1===i._wont()||this.sendIAC(e.IAC+e.DONT+o))}else t.charAt(1)===e.DO?this.sendIAC(e.IAC+e.WONT+o):t.charAt(1)===e.WILL&&this.sendIAC(e.IAC+e.DONT+o)},s.prototype.requestPermission=function(t,e,i){var s=this.store.get(t);if(null==s){var o=this;this.ui&&this.ui.infoBar&&this.ui.infoBar(e,"permission",0,void 0,[["Allow".tr(this),function(){o.store.set(t,!0),i.call(o,!0)}],["Deny".tr(this),function(){o.store.set(t,!1),i.call(o,!1)}]],void 0,(function(t){i.call(o,!1)}))}else i.call(this,!!s)},s.settings={startup:{_path:"/",_desc:"Control what happens when DecafMUD is opened.",autoconnect:{_type:"boolean",_desc:"Automatically connect to the server."},autoreconnect:{_type:"boolean",_desc:"Automatically reconnect when the connection is lost."}},appearance:{_path:"display/",_desc:"Control the appearance of the client.",font:{_type:"font",_desc:"The font to display MUD output in."}}},s.options={host:void 0,port:4e3,autoconnect:!0,connectonsend:!0,autoreconnect:!0,connect_timeout:5e3,reconnect_delay:5e3,reconnect_tries:3,storage:"standard",display:"standard",encoding:"iso88591",socket:"flash",interface:"simple",language:"autodetect",jslocation:void 0,wait_delay:25,wait_tries:1e3,load_language:!0,plugins:[],set_storage:{},set_display:{handlecolor:!0,fgclass:"c",bgclass:"b",fntclass:"fnt",inputfg:"-7",inputbg:"-0"},set_socket:{policyport:void 0,swf:"/media/DecafMUDFlashSocket.swf",wsport:void 0,wspath:""},set_interface:{container:void 0,start_full:!1,mru:!0,mru_size:15,multiline:!0,clearonsend:!1,focusinput:!0,repeat_input:!0,blurclass:"mud-input-blur",msg_connect:"Press Enter to connect and type here...",msg_connecting:"DecafMUD is attempting to connect...",msg_empty:"Type commands here, or use the Up and Down arrows to browse your recently used commands.",connect_hint:!0},ttypes:["decafmud-"+s.version,"decafmud","xterm","unknown"],environ:{},encoding_order:["utf8"],plugin_order:[]},e.DecafMUD=s}(window)},41:()=>{!function(t){var e=function(t){this.decaf=t};e.prototype.host=void 0,e.prototype.port=void 0,e.prototype.ssl=void 0,e.prototype.connected=!1,e.prototype.ready=!1,e.prototype.websocket=null,e.prototype.setup=function(){if("WebSocket"in window)return this.ready=!0,void this.decaf.socketReady(this);clearTimeout(this.decaf.timer),this.decaf.error("Unable to create a WebSocket. Does your browser support them? If not, try {0}.".tr(this.decaf,'<a href="http://www.google.com/chrome" target="_blank">Google Chrome</a>'))},e.prototype.connect=function(){this.connected&&this.websocket&&(this.websocket.close(),this.websocket=null);var t=this.port;void 0===t&&(((t=this.decaf.options.set_socket.wsport)<1||t>65535)&&(t=this.decaf.options.set_socket.policyport),void 0===t&&(t=843),this.port=t);var e=this.decaf.options.set_socket.wspath;void 0===e&&(e="port_"+this.decaf.options.port);var i=this.host;void 0===i&&((i=this.decaf.options.host)||(i=document.location.host),this.host=i);var s=this.ssl;void 0===s&&(void 0===(s=this.decaf.options.set_socket.ssl)&&(s=!1),this.ssl=s);var o="ws"+(s?"s":"")+"://"+i+":"+t+"/"+e;this.decaf.debugString("WebSocket Connection String: "+o),this.websocket=new WebSocket(o,"binary"),this.websocket.onopen=this.onOpen.bind(this,this.websocket),this.websocket.onclose=this.onClose.bind(this,this.websocket),this.websocket.onmessage=this.onMessage.bind(this,this.websocket)},e.prototype.close=function(){this.connected=!1,this.websocket&&(this.websocket.close(),this.websocket=null)},e.prototype.assertConnected=function(){if(!this.connected||!this.websocket)throw"DecafMUD is not currently connected."},e.prototype.write=function(t){this.assertConnected();for(var e=new Array(t.length),i=0;i<t.length;i++)e[i]=t.charCodeAt(i);var s=new Uint8Array(e).buffer;this.websocket.send(s)},e.prototype.onOpen=function(t,e){1===t.readyState&&(this.connected=!0,this.decaf.socketConnected())},e.prototype.onClose=function(t,e){this.connected&&(this.connected=!1,this.decaf.socketClosed(),this.websocket==t&&(this.websocket=null))},e.prototype.onMessage=function(t,e){var i=new FileReader;i.onload=function(t){var e,i=new Uint8Array(t.target.result),s="";for(e=0;e<i.length;++e)s+=String.fromCharCode(i[e]);this.decaf.socketData(s)}.bind(this),i.readAsArrayBuffer(e.data)},t.plugins.Socket.websocket=e}(DecafMUD)},618:()=>{!function(t){var e=function t(e,i){if(void 0===i&&(i=""),this.path=i+"/",e instanceof t?(this.decaf=e.decaf,e.children.push(this)):this.decaf=e,this.children=[],!1 in window)throw"This storage backend can only be used in browsers supporting localStorage.";return this};e.prototype.get=function(t,e){var i=window.localStorage[this.path+t];return null==i?e:JSON.parse(i)},e.prototype.set=function(t,e){e="string"==typeof e?'"'+e+'"':JSON.stringify(e),window.localStorage[this.path+t]=e},e.prototype.del=function(t){return delete window.localStorage[this.path+t]},e.prototype.sub=function(t){return new e(this,this.path+t)},e.prototype.keys=function(){for(var t=[],e=window.localStorage.length,i=this.path,s=0;s<e;s++){var o=window.localStorage.key(s);-1!==o.indexOf(i)&&t.push(o.substr(i.length))}return t},e.prototype.change=function(t){var e=this.path,i=this.children.length;this.path=t+"/";for(var s=0;s<i;s++){var o=this.path+this.children[s].path.substr(e.length);o=o.substr(0,o.length-1),this.children[s].change(o)}},t.plugins.Storage.standard=e}(DecafMUD)}},e={};function s(i){var o=e[i];if(void 0!==o)return o.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}(()=>{"use strict";var t;s(164),s(535),s(669),s(129),s(41),s(618),t=function(){new DecafMUD({host:"waterpoint-wss.the-b.org",autoreconnect:!1,autoconnect:!0,set_socket:{wsport:443,wspath:"/client/websocket",ssl:!0},set_interface:{container:"#wpt-client",connect_hint:!1,repeat_input:!1,start_full:!1},language:"en",encoding:"utf8",socket:"websocket"})},"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)})()})();